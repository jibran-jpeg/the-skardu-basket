import{c as i,u as A,g as E,b as T,r as b,S as U,j as e,A as w,w as I}from"./index-BAFKV7Dd.js";import{U as H}from"./users-D0zrC-9q.js";import{C as F}from"./calendar-pf0QEVTx.js";/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const q=[["path",{d:"m7 7 10 10",key:"1fmybs"}],["path",{d:"M17 7v10H7",key:"6fjiku"}]],K=i("arrow-down-right",q);/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const V=[["path",{d:"M7 7h10v10",key:"1tivn9"}],["path",{d:"M7 17 17 7",key:"1vkiza"}]],B=i("arrow-up-right",V);/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const W=[["line",{x1:"12",x2:"12",y1:"2",y2:"22",key:"7eqyqh"}],["path",{d:"M17 5H9.5a3.5 3.5 0 0 0 0 7h5a3.5 3.5 0 0 1 0 7H6",key:"1b0p4s"}]],J=i("dollar-sign",W);/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Q=[["path",{d:"M12 15V3",key:"m9g1x1"}],["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["path",{d:"m7 10 5 5 5-5",key:"brsn70"}]],G=i("download",Q);/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const X=[["path",{d:"M16 7h6v6",key:"box55l"}],["path",{d:"m22 7-8.5 8.5-5-5L2 17",key:"1t1m79"}]],j=i("trending-up",X);function te(){const p=A(),{getAllOrders:k}=E(),{products:u}=T(),[o,g]=b.useState([]),[N,f]=b.useState(!0);b.useEffect(()=>{(async()=>{f(!0);try{const r=await k(),a=await Promise.all((r||[]).map(async s=>{const{data:n}=await I.from("order_items").select("*").eq("order_id",s.id).limit(1);return{...s,items:n||[]}}));g(a)}catch(r){console.error("Error fetching dashboard data:",r),g([])}finally{f(!1)}})()},[]);const d=o.reduce((t,r)=>t+(r.total||0),0),c=o.length,S=new Set(o.map(t=>t.customer_email)).size,_=c>0?d/c:0,P=o.reduce((t,r)=>{const a=r.city||"Unknown";return t[a]||(t[a]={count:0,revenue:0}),t[a].count++,t[a].revenue+=r.total||0,t},{}),l=Object.entries(P).sort((t,r)=>r[1].revenue-t[1].revenue)[0],x=l?l[0]:"N/A",v=l?l[1].revenue:0,m=d>0?Math.round(v/d*100):0,$=[{label:"Total Revenue",value:`PKR ${d.toLocaleString()}`,change:"+12.5%",isPositive:!0,icon:J,theme:"from-emerald-400 to-emerald-600"},{label:"Total Orders",value:c.toString(),change:"+8.2%",isPositive:!0,icon:U,theme:"from-blue-400 to-blue-600"},{label:"Active Customers",value:S.toString(),change:"-2.4%",isPositive:!1,icon:H,theme:"from-brand-primary to-brand-dark"},{label:"Avg. Order Value",value:`PKR ${Math.round(_).toLocaleString()}`,change:"+4.1%",isPositive:!0,icon:j,theme:"from-amber-400 to-amber-600"}],O=t=>{const r=new Date(t),s=new Date-r,n=Math.floor(s/6e4),h=Math.floor(s/36e5),y=Math.floor(s/864e5);return n<60?`${n} mins ago`:h<24?`${h} hour${h>1?"s":""} ago`:`${y} day${y>1?"s":""} ago`},R=t=>({pending:"Pending",processing:"Processing",delivered:"Delivered",cancelled:"Cancelled"})[t]||t,C=o.slice(0,5).map(t=>{var r,a,s;return{id:`#${t.order_number}`,customer:t.customer_name,product:((a=(r=t.items)==null?void 0:r[0])==null?void 0:a.product_name)||"Multiple Items",amount:`PKR ${(s=t.total)==null?void 0:s.toLocaleString()}`,status:R(t.status),date:O(t.created_at)}}),M=()=>{const t=[["Order Number","Customer","Email","Total","Status","Date"],...o.map(n=>[n.order_number,n.customer_name,n.customer_email,n.total,n.status,new Date(n.created_at).toLocaleDateString()])].map(n=>n.join(",")).join(`
`),r=new Blob([t],{type:"text/csv"}),a=window.URL.createObjectURL(r),s=document.createElement("a");s.href=a,s.download=`orders-report-${new Date().toISOString().split("T")[0]}.csv`,s.click(),window.URL.revokeObjectURL(a)},L=t=>{switch(t){case"Delivered":return"bg-emerald-500/10 text-emerald-600 dark:text-emerald-400 border-emerald-500/20";case"Processing":return"bg-blue-500/10 text-blue-600 dark:text-blue-400 border-blue-500/20";case"Pending":return"bg-amber-500/10 text-amber-600 dark:text-amber-400 border-amber-500/20";case"Cancelled":return"bg-red-500/10 text-red-600 dark:text-red-400 border-red-500/20";default:return"bg-gray-100 dark:bg-white/5 text-gray-600 dark:text-gray-400 border-gray-200 dark:border-white/10"}},D=u.filter(t=>t.stock>0&&t.stock<=5).length,z=o.filter(t=>t.status==="cancelled").length;return N?e.jsx("div",{className:"flex items-center justify-center min-h-screen",children:e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"w-16 h-16 border-4 border-brand-primary border-t-transparent rounded-full animate-spin mx-auto mb-4"}),e.jsx("p",{className:"text-gray-600 dark:text-gray-400 font-medium",children:"Loading dashboard..."})]})}):e.jsxs("div",{className:"space-y-12 animate-fade-in-up max-w-[1600px] mx-auto relative z-10",children:[e.jsxs("div",{className:"flex flex-col md:flex-row md:items-center justify-between gap-6",children:[e.jsxs("div",{children:[e.jsxs("h1",{className:"text-3xl md:text-5xl font-serif font-bold text-gray-900 dark:text-white mb-2 tracking-tight drop-shadow-sm",children:["Mountain Harvest ",e.jsxs("span",{className:"text-brand-primary dark:text-brand-accent italic relative",children:["Analytics",e.jsx("span",{className:"absolute -bottom-2 left-0 w-full h-1 bg-brand-primary/20 dark:bg-brand-accent/50 rounded-full blur-sm"})]})]}),e.jsxs("p",{className:"text-gray-500 dark:text-gray-400 font-medium flex items-center gap-2 text-lg",children:[e.jsx(F,{size:18,className:"text-brand-primary dark:text-brand-accent"}),"Saturday, January 31, 2026"]})]}),e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsxs("button",{onClick:M,className:"px-6 py-3 bg-white/60 dark:bg-black/20 backdrop-blur-sm border border-gray-200 dark:border-white/10 rounded-2xl text-xs font-bold text-gray-600 dark:text-gray-300 hover:bg-white dark:hover:bg-white/10 transition-all shadow-sm hover:shadow-lg flex items-center gap-2 group",children:[e.jsx(G,{size:14,className:"group-hover:-translate-y-0.5 transition-transform"}),"Export Report"]}),e.jsxs("button",{onClick:()=>p("/admin/products"),className:"px-6 py-3 bg-brand-primary text-white rounded-2xl text-xs font-bold shadow-xl shadow-brand-primary/20 hover:scale-[1.03] active:scale-[0.98] transition-all hover:shadow-brand-primary/40 flex items-center gap-2 group",children:[e.jsx("span",{children:"New Product"}),e.jsx(w,{size:14,className:"group-hover:translate-x-1 transition-transform"})]})]})]}),e.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 xl:grid-cols-4 gap-6 md:gap-8",children:$.map((t,r)=>e.jsxs("div",{className:"relative group bg-white/60 dark:bg-[#1F2833]/80 backdrop-blur-xl p-8 rounded-[2rem] border border-white/40 dark:border-white/5 hover:border-brand-primary/30 dark:hover:border-brand-accent/30 shadow-xl shadow-gray-100/50 dark:shadow-[0_0_40px_-10px_rgba(224,159,62,0.1)] transition-all duration-500 overflow-hidden cursor-pointer hover:-translate-y-1",children:[e.jsx("div",{className:`absolute -top-12 -right-12 w-40 h-40 bg-gradient-to-br ${t.theme} opacity-[0.08] group-hover:opacity-[0.2] rounded-full blur-3xl transition-all duration-700 group-hover:scale-125`}),e.jsxs("div",{className:"relative z-10",children:[e.jsxs("div",{className:"flex items-center justify-between mb-8",children:[e.jsx("div",{className:`w-14 h-14 bg-gradient-to-br ${t.theme} rounded-2xl flex items-center justify-center text-white shadow-lg shadow-brand-primary/10 group-hover:scale-110 group-hover:rotate-6 transition-transform duration-500 ring-4 ring-white/50 dark:ring-black/20`,children:e.jsx(t.icon,{size:24})}),e.jsxs("div",{className:`flex items-center gap-1.5 px-3 py-1.5 rounded-full text-xs font-bold backdrop-blur-sm ${t.isPositive?"bg-emerald-500/10 text-emerald-600 dark:text-emerald-400 border border-emerald-500/20":"bg-red-500/10 text-red-600 dark:text-red-400 border border-red-500/20"}`,children:[t.isPositive?e.jsx(B,{size:14}):e.jsx(K,{size:14}),t.change]})]}),e.jsx("h3",{className:"text-gray-400 dark:text-gray-500 text-xs font-bold uppercase tracking-[0.2em] mb-2",children:t.label}),e.jsx("p",{className:"text-3xl font-serif font-bold text-gray-900 dark:text-white tracking-tight group-hover:text-brand-primary dark:group-hover:text-brand-accent transition-colors",children:t.value})]})]},r))}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-10",children:[e.jsxs("div",{className:"lg:col-span-2 space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("h2",{className:"text-2xl font-serif font-bold text-gray-900 dark:text-white",children:"Recent Transactions"}),e.jsxs("button",{onClick:()=>p("/admin/orders"),className:"group flex items-center gap-2 text-xs font-bold text-brand-primary hover:text-brand-dark transition-colors px-4 py-2 hover:bg-brand-primary/5 rounded-lg",children:["VIEW ALL ORDERS ",e.jsx(w,{size:14,className:"group-hover:translate-x-1 transition-transform"})]})]}),e.jsxs("div",{className:"bg-white/60 dark:bg-[#1F2833]/60 backdrop-blur-xl rounded-[2.5rem] border border-white/40 dark:border-white/5 overflow-hidden shadow-sm relative",children:[e.jsx("div",{className:"absolute top-0 right-0 w-96 h-96 bg-brand-primary/5 rounded-full blur-[100px] -translate-y-1/2 translate-x-1/2 pointer-events-none"}),e.jsx("div",{className:"overflow-x-auto relative z-10 p-2",children:e.jsxs("table",{className:"w-full text-left border-collapse",children:[e.jsx("thead",{children:e.jsxs("tr",{className:"border-b border-gray-100 dark:border-white/5",children:[e.jsx("th",{className:"px-8 py-6 text-[10px] uppercase tracking-widest text-gray-400 font-bold",children:"Order Info"}),e.jsx("th",{className:"px-6 py-6 text-[10px] uppercase tracking-widest text-gray-400 font-bold",children:"Items"}),e.jsx("th",{className:"px-6 py-6 text-[10px] uppercase tracking-widest text-gray-400 font-bold",children:"Status"}),e.jsx("th",{className:"px-8 py-6 text-[10px] uppercase tracking-widest text-gray-400 font-bold text-right",children:"Amount"})]})}),e.jsx("tbody",{className:"divide-y divide-gray-100 dark:divide-white/5",children:C.map(t=>e.jsxs("tr",{className:"group hover:bg-white/50 dark:hover:bg-white/5 transition-all cursor-pointer rounded-2xl hover:shadow-none hover:scale-[1.01] duration-300 border-transparent border hover:border-gray-200 dark:hover:border-white/5",children:[e.jsx("td",{className:"px-8 py-5",children:e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx("div",{className:"w-12 h-12 rounded-2xl bg-brand-primary/10 border border-brand-primary/10 flex items-center justify-center text-sm font-bold text-brand-primary font-serif group-hover:bg-brand-primary group-hover:text-white transition-colors duration-300",children:t.customer.charAt(0)}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-bold text-gray-900 dark:text-white leading-none mb-1.5",children:t.customer}),e.jsxs("p",{className:"text-[10px] font-bold text-gray-400 tracking-wide uppercase",children:[t.id," â€¢ ",t.date]})]})]})}),e.jsx("td",{className:"px-6 py-5",children:e.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-300 font-medium line-clamp-1 max-w-[180px]",children:t.product})}),e.jsx("td",{className:"px-6 py-5 text-center",children:e.jsx("span",{className:`inline-block px-4 py-1.5 rounded-full text-[10px] font-bold border uppercase tracking-wider backdrop-blur-sm shadow-sm ${L(t.status)}`,children:t.status})}),e.jsx("td",{className:"px-8 py-5 text-right",children:e.jsx("p",{className:"text-sm font-bold text-gray-900 dark:text-white font-serif",children:t.amount})})]},t.id))})]})})]})]}),e.jsxs("div",{className:"space-y-8",children:[e.jsxs("div",{children:[e.jsx("h2",{className:"text-2xl font-serif font-bold text-gray-900 dark:text-white mb-6",children:"Store Performance"}),e.jsxs("div",{className:"bg-brand-primary rounded-[2.5rem] p-10 text-white relative overflow-hidden group shadow-2xl shadow-brand-primary/20 hover:shadow-brand-primary/40 transition-shadow duration-500",children:[e.jsx("div",{className:"absolute inset-0 opacity-10 bg-[url('https://www.transparenttextures.com/patterns/leaf.png')]"}),e.jsx("div",{className:"absolute top-0 right-0 w-56 h-56 bg-white/10 rounded-full blur-3xl -translate-y-1/2 translate-x-1/2 group-hover:scale-125 transition-transform duration-1000"}),e.jsxs("div",{className:"relative z-10",children:[e.jsxs("p",{className:"text-[10px] font-bold uppercase tracking-[0.2em] text-brand-accent mb-6 flex items-center gap-2",children:[e.jsx("span",{className:"w-1.5 h-1.5 rounded-full bg-brand-accent animate-pulse"}),"Top Performing City"]}),e.jsx("h3",{className:"text-4xl font-serif font-bold mb-3",children:x}),e.jsx("p",{className:"text-sm text-white/80 mb-10 border-l-2 border-brand-accent pl-5 leading-relaxed",children:d>0?e.jsxs(e.Fragment,{children:["This city is driving ",e.jsxs("strong",{className:"text-white",children:[m,"% of total revenue"]})," with PKR ",v.toLocaleString()," in sales."]}):e.jsx(e.Fragment,{children:"No order data available yet."})}),e.jsxs("div",{className:"space-y-5",children:[e.jsx("div",{className:"h-2 w-full bg-black/20 rounded-full overflow-hidden backdrop-blur-sm",children:e.jsx("div",{className:"h-full bg-brand-accent animate-pulse relative overflow-hidden",style:{width:`${m}%`},title:x,children:e.jsx("div",{className:"absolute inset-0 bg-white/20 -translate-x-full animate-[shimmer_2s_infinite]"})})}),e.jsxs("div",{className:"flex justify-between text-[10px] font-bold uppercase tracking-wider text-white/90",children:[e.jsxs("span",{children:[x," Sales"]}),e.jsxs("span",{children:[m,"% Share"]})]})]})]})]})]}),e.jsxs("div",{className:"p-8 bg-white/60 dark:bg-[#1F2833]/80 backdrop-blur-xl rounded-[2.5rem] border border-white/40 dark:border-white/5 shadow-sm relative overflow-hidden hover:shadow-xl transition-all duration-300",children:[e.jsx("div",{className:"absolute top-0 left-0 w-full h-1 bg-gradient-to-r from-brand-primary via-brand-accent to-brand-primary opacity-50"}),e.jsxs("h3",{className:"text-sm font-bold text-gray-900 dark:text-white mb-6 uppercase tracking-widest flex items-center justify-between",children:["Quick Insights",e.jsx(j,{size:16,className:"text-brand-primary dark:text-brand-accent"})]}),e.jsx("div",{className:"space-y-4",children:[{label:"Total Products",val:u.length.toString(),color:"text-emerald-500",bg:"bg-emerald-500/10"},{label:"Cancelled Orders",val:z.toString(),color:"text-red-500",bg:"bg-red-500/10"},{label:"Low Stock Alerts",val:D.toString(),color:"text-amber-500",bg:"bg-amber-500/10"}].map((t,r)=>e.jsxs("div",{className:"flex justify-between items-center p-3 rounded-2xl hover:bg-gray-50 dark:hover:bg-white/5 transition-colors cursor-pointer group",children:[e.jsx("span",{className:"text-xs text-gray-500 font-bold uppercase tracking-wide group-hover:text-brand-primary transition-colors",children:t.label}),e.jsx("span",{className:`text-xs font-bold px-3 py-1 rounded-full ${t.color} ${t.bg}`,children:t.val})]},r))})]})]})]})]})}export{te as Dashboard};
