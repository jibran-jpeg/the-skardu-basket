import{c as g,b as E,r as p,j as e,I,X as P,T as F,s as f,x as d}from"./index-BLe-v4rb.js";import{C as z}from"./cloud-upload-BCKdkzuw.js";/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const M=[["ellipse",{cx:"12",cy:"5",rx:"9",ry:"3",key:"msslwz"}],["path",{d:"M3 5V19A9 3 0 0 0 21 19V5",key:"1wlel7"}],["path",{d:"M3 12A9 3 0 0 0 21 12",key:"mv7ke4"}]],T=g("database",M);/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const U=[["path",{d:"M20 20a2 2 0 0 0 2-2V8a2 2 0 0 0-2-2h-7.9a2 2 0 0 1-1.69-.9L9.6 3.9A2 2 0 0 0 7.93 3H4a2 2 0 0 0-2 2v13a2 2 0 0 0 2 2Z",key:"1kt360"}]],_=g("folder",U);/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const R=[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",key:"afitv7"}],["path",{d:"M3 9h18",key:"1pudct"}],["path",{d:"M3 15h18",key:"5xshup"}],["path",{d:"M9 3v18",key:"fh3hqa"}],["path",{d:"M15 3v18",key:"14nvp0"}]],q=g("grid-3x3",R);/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const A=[["path",{d:"M15.2 3a2 2 0 0 1 1.4.6l3.8 3.8a2 2 0 0 1 .6 1.4V19a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2z",key:"1c8476"}],["path",{d:"M17 21v-7a1 1 0 0 0-1-1H8a1 1 0 0 0-1 1v7",key:"1ydtos"}],["path",{d:"M7 3v4a1 1 0 0 0 1 1h7",key:"t51u73"}]],L=g("save",A);function G(){const{categories:y,addCategory:w,updateCategory:v,deleteCategory:k}=E(),[c,b]=p.useState(null),[u,x]=p.useState(!1),[t,n]=p.useState({id:"",name:"",description:"",image:""}),h=()=>{n({id:"",name:"",description:"",image:""}),b(null),x(!1)},j=r=>{b(r),n(r),x(!0)},N=r=>{window.confirm("Are you sure you want to delete this category?")&&k(r)},C=r=>{r.preventDefault();const i={...t,id:c?t.id:t.id||t.name.toLowerCase().replace(/\s+/g,"-")};c?v(i):w(i),h()},D=r=>{const i=r.target.files[0];if(i){const s=new FileReader;s.onloadend=()=>{n({...t,image:s.result})},s.readAsDataURL(i)}},S=r=>{if(!r)return null;const i=new Date(r);return isNaN(i.getTime())?null:i.toISOString().split("T")[0]},$=async()=>{if(window.confirm("This will populate the database with initial products and categories from the store configuration. Existing data with same Names/IDs will be updated. Continue?"))try{console.log("Seeding categories...");for(const r of f.categories){const{data:i,error:s}=await d.from("categories").select("id").eq("id",r.id).single();if(s&&s.code!=="PGRST116"&&console.error("Check Category Error:",s),i){const{error:a}=await d.from("categories").update(r).eq("id",r.id);if(a)throw console.error("Update Category Error:",a),new Error(`Cat Update Failed: ${a.message} (${a.code}) - ${a.details}`)}else{const{error:a}=await d.from("categories").insert(r);if(a)if(console.error("Insert Category Error:",a),a.code==="22P02"){console.warn("Retrying category insert without ID");const{id:m,...l}=r,{error:o}=await d.from("categories").insert(l);if(o)throw new Error(`Cat Insert Retry Failed: ${o.message} (${o.code})`)}else throw new Error(`Cat Insert Failed: ${a.message} (${a.code}) - ${a.details} - ${a.hint}`)}}console.log("Seeding products...");for(const r of f.products){const{id:i,...s}=r,a={...s,price:Number(s.price),rating:Number(s.rating),reviews:Number(s.reviews),harvestDate:s.harvestDate?S(s.harvestDate):null};a.harvestDate||delete a.harvestDate;const{data:m,error:l}=await d.from("products").select("id").eq("name",r.name).single();if(l&&l.code!=="PGRST116"&&console.error("Check Product Error:",l),m){console.log(`Updating product: ${r.name}`);const{error:o}=await d.from("products").update(a).eq("id",m.id);if(o)throw new Error(`Prod Update Failed: ${o.message} - ${o.details}`)}else{console.log(`Inserting product: ${r.name}`);const{error:o}=await d.from("products").insert(a);if(o)throw console.error("Insert Product Error:",o),new Error(`Prod Insert Failed: ${o.message} (${o.code}) - ${o.details} - ${o.hint}`)}}alert("Database seeded successfully! The page will reload."),window.location.reload()}catch(r){console.error("Seeding failed:",r),alert(`Seeding failed: ${r.message}`)}};return e.jsxs("div",{className:"space-y-8 animate-fade-in-up",children:[e.jsxs("div",{className:"flex flex-col md:flex-row md:items-center justify-between gap-6",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex items-center gap-2 text-[10px] text-gray-500 dark:text-gray-400 font-bold uppercase tracking-wider",children:[e.jsx("span",{children:"Configuration"}),e.jsx("span",{className:"text-gray-300",children:"/"}),e.jsx("span",{className:"text-brand-primary dark:text-brand-accent",children:"Platform"})]}),e.jsx("h1",{className:"text-3xl md:text-5xl font-serif font-bold text-gray-900 dark:text-white tracking-tight",children:"Store Settings"}),e.jsx("p",{className:"text-sm text-gray-500 dark:text-gray-400 max-w-lg",children:"Manage global configurations, categories, and store information."})]}),e.jsxs("button",{onClick:$,className:"flex items-center gap-2 px-5 py-3 bg-white dark:bg-white/5 border border-brand-primary/20 dark:border-white/10 text-brand-primary dark:text-white rounded-xl font-bold uppercase tracking-wider text-xs hover:bg-brand-primary/5 hover:border-brand-primary/50 transition-all",children:[e.jsx(T,{size:16})," Seed Database"]})]}),e.jsxs("div",{className:"bg-white/60 dark:bg-[#1F2833]/60 backdrop-blur-xl rounded-[2.5rem] p-8 border border-white/40 dark:border-white/5 relative overflow-hidden",children:[e.jsx("div",{className:"absolute top-0 right-0 w-96 h-96 bg-brand-primary/5 rounded-full blur-[100px] pointer-events-none -translate-y-1/2 translate-x-1/2"}),e.jsxs("div",{className:"flex items-center justify-between mb-8 relative z-10",children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx("div",{className:"p-3 bg-brand-primary/10 text-brand-primary rounded-2xl",children:e.jsx(q,{size:24})}),e.jsxs("div",{children:[e.jsx("h2",{className:"text-xl font-serif font-bold text-gray-900 dark:text-white",children:"Product Categories"}),e.jsx("p",{className:"text-xs text-gray-500 dark:text-gray-400",children:"Define the main sections of your store"})]})]}),!u&&e.jsxs("button",{onClick:()=>x(!0),className:"flex items-center gap-2 px-5 py-2.5 bg-brand-primary text-white rounded-xl text-sm font-bold uppercase tracking-wider hover:bg-brand-dark transition-all shadow-lg shadow-brand-primary/20 hover:-translate-y-0.5",children:[e.jsx(I,{size:16})," New Category"]})]}),u?e.jsxs("div",{className:"bg-gray-50 dark:bg-black/20 rounded-3xl p-6 border border-gray-200 dark:border-white/5 animate-fade-in",children:[e.jsxs("div",{className:"flex items-center justify-between mb-6",children:[e.jsx("h3",{className:"font-bold text-gray-900 dark:text-white",children:c?"Edit Category":"New Category"}),e.jsx("button",{onClick:h,className:"p-2 text-gray-400 hover:text-red-500 transition-colors",children:e.jsx(P,{size:20})})]}),e.jsxs("form",{onSubmit:C,className:"space-y-6",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-bold uppercase tracking-wider text-gray-500 mb-2",children:"Category Name"}),e.jsx("input",{type:"text",required:!0,value:t.name,onChange:r=>n({...t,name:r.target.value}),className:"w-full px-4 py-3 bg-white dark:bg-[#151c24] border border-gray-200 dark:border-white/10 rounded-xl focus:ring-2 focus:ring-brand-primary/20 focus:border-brand-primary outline-none transition-all",placeholder:"e.g. Seasonal Fruits"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-bold uppercase tracking-wider text-gray-500 mb-2",children:"Category ID (Slug)"}),e.jsx("input",{type:"text",value:t.id,disabled:!!c,onChange:r=>n({...t,id:r.target.value.toLowerCase().replace(/\s+/g,"-")}),className:"w-full px-4 py-3 bg-gray-100 dark:bg-white/5 border border-gray-200 dark:border-white/10 rounded-xl text-gray-500 cursor-not-allowed outline-none font-mono text-sm",placeholder:"Auto-generated"})]}),e.jsxs("div",{className:"md:col-span-2",children:[e.jsx("label",{className:"block text-xs font-bold uppercase tracking-wider text-gray-500 mb-2",children:"Description"}),e.jsx("textarea",{value:t.description,onChange:r=>n({...t,description:r.target.value}),className:"w-full px-4 py-3 bg-white dark:bg-[#151c24] border border-gray-200 dark:border-white/10 rounded-xl focus:ring-2 focus:ring-brand-primary/20 focus:border-brand-primary outline-none transition-all h-24 resize-none",placeholder:"Brief description for SEO and cards..."})]}),e.jsxs("div",{className:"md:col-span-2",children:[e.jsx("label",{className:"block text-xs font-bold uppercase tracking-wider text-gray-500 mb-2",children:"Cover Image"}),e.jsxs("div",{className:"flex items-center gap-4",children:[t.image&&e.jsx("img",{src:t.image,alt:"Preview",className:"w-16 h-16 rounded-xl object-cover border border-gray-200 dark:border-white/10"}),e.jsxs("label",{className:"flex items-center gap-2 px-4 py-3 bg-white dark:bg-[#151c24] border border-dashed border-gray-300 dark:border-white/20 rounded-xl cursor-pointer hover:border-brand-primary hover:text-brand-primary transition-all text-sm text-gray-500 dark:text-gray-400",children:[e.jsx(z,{size:18}),e.jsx("span",{children:t.image?"Change Image":"Upload Image"}),e.jsx("input",{type:"file",accept:"image/*",onChange:D,className:"hidden"})]})]})]})]}),e.jsxs("div",{className:"flex justify-end gap-3 pt-4 border-t border-gray-200 dark:border-white/5",children:[e.jsx("button",{type:"button",onClick:h,className:"px-5 py-2.5 rounded-xl font-bold text-gray-500 hover:bg-gray-100 dark:hover:bg-white/5 transition-all text-sm uppercase",children:"Cancel"}),e.jsxs("button",{type:"submit",className:"px-6 py-2.5 bg-brand-primary text-white rounded-xl font-bold uppercase tracking-wider text-sm shadow-lg shadow-brand-primary/20 hover:bg-brand-dark transition-all flex items-center gap-2",children:[e.jsx(L,{size:16})," Save Category"]})]})]})]}):e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 xl:grid-cols-3 gap-4",children:y.map(r=>e.jsxs("div",{className:"group p-5 bg-white/50 dark:bg-white/5 hover:bg-white dark:hover:bg-[#151c24] border border-gray-100 dark:border-white/5 rounded-3xl transition-all hover:shadow-xl hover:shadow-gray-200/50 dark:hover:shadow-black/50 hover:-translate-y-1 relative",children:[e.jsxs("div",{className:"flex items-start gap-4",children:[e.jsx("div",{className:"w-16 h-16 rounded-2xl bg-gray-100 dark:bg-black/20 overflow-hidden shrink-0 border border-gray-200 dark:border-white/5",children:e.jsx("img",{src:r.image,alt:r.name,className:"w-full h-full object-cover group-hover:scale-110 transition-transform duration-500"})}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("h3",{className:"font-bold text-gray-900 dark:text-white font-serif",children:r.name}),e.jsx("p",{className:"text-[10px] text-gray-400 font-mono mt-0.5 truncate uppercase tracking-widest",children:r.id}),e.jsx("p",{className:"text-xs text-gray-500 dark:text-gray-400 mt-2 line-clamp-2",children:r.description})]})]}),e.jsxs("div",{className:"absolute top-4 right-4 flex gap-1 opacity-0 group-hover:opacity-100 transition-opacity",children:[e.jsx("button",{onClick:()=>j(r),className:"p-2 text-blue-500 hover:bg-blue-50 dark:hover:bg-blue-500/10 rounded-lg transition-colors",children:e.jsx(_,{size:14})}),e.jsx("button",{onClick:()=>N(r.id),className:"p-2 text-red-500 hover:bg-red-50 dark:hover:bg-red-500/10 rounded-lg transition-colors",children:e.jsx(F,{size:14})})]})]},r.id))})]})]})}export{G as Settings};
